C51 COMPILER V9.60.0.0   BSP_MAIN                                                          02/26/2020 22:34:49 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE BSP_MAIN
OBJECT MODULE PLACED IN ..\Objects\bsp_main.obj
COMPILER INVOKED BY: C:\keil\C51\BIN\C51.EXE ..\user\bsp_main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\user;..\BSP\inc) DEBU
                    -G OBJECTEXTEND PRINT(..\Listings\bsp_main.lst) OBJECT(..\Objects\bsp_main.obj)

line level    source

   1          #include "inc.h"
   2          
   3          void Delay200ms()               //@11.0592MHz
   4          {
   5   1              unsigned char i, j, k;
   6   1              _nop_();
   7   1              i = 2;
   8   1              j = 103;
   9   1              k = 0;
  10   1              do
  11   1              {
  12   2                      do
  13   2                      {
  14   3                              while (--k);
  15   3                      } while (--j);
  16   2              } while (--i);
  17   1      }
  18          
  19          
  20          
  21          
  22          void lcd_display(void);
  23          extern uint8_t showflag;
  24          void main(void)
  25          {
  26   1          xdata float _fhumi,_ftemp;
  27   1              
  28   1              static uint8_t time_flag = 0;
  29   1              static float humi_flag = 0;
  30   1              static float temp_flag = 0;
  31   1              
  32   1              
  33   1              uchar* pTime = (void*) 0;
  34   1          xdata char table[17];
  35   1              lcd_display();
  36   1              Timer0Init();
  37   1              UartInit();
  38   1          s_connectionreset();
  39   1              ds1302_init(); //DS1302初始化
  40   1              ds1302_write_time(); //写入初始值
  41   1              while(1)
  42   1              {
  43   2              switch(showflag){
  44   3                              case 0:
  45   3                                      _fhumi = fGetHumi();
  46   3                                      _ftemp = fGetTemp();
  47   3                                      if(temp_flag != _ftemp){
  48   4                                              sprintf(table, "TEMP:%05.1f  ", _ftemp);
  49   4                                              LcdShowStr(0x80,table);
  50   4                                              lcdshowCelsius(0x80 + 12);
  51   4                                              temp_flag = _ftemp;
  52   4                                      }
  53   3                                      if(humi_flag != _fhumi){
  54   4                                              sprintf(table, "HUMI:%05.1f  %%   ",_fhumi);
C51 COMPILER V9.60.0.0   BSP_MAIN                                                          02/26/2020 22:34:49 PAGE 2   

  55   4                                              LcdShowStr(0x80 + 0x40,table);  
  56   4                                              humi_flag = _fhumi;
  57   4                                      }
  58   3                              break;
  59   3                              case 1:
  60   3                                      pTime = GetTime();
  61   3                                      if(pTime[13] != time_flag)
  62   3                                      {
  63   4                                              temp_flag = 0;
  64   4                                              humi_flag = 0;
  65   4                                              time_flag = pTime[13];
  66   4                                              sprintf(table, "Y:%04dM:%02dD:%02d  ", (int)(pTime[0]*1000 + pTime[1]*100+pTime[2]*10 + pTime[3]),
  67   4                                                                                                                        (int)(pTime[4]*10 + pTime[5]),
  68   4                                                                                                                        (int)(pTime[6]*10 + pTime[7]));
  69   4                                              LcdShowStr(0x80,table);                                                                 
  70   4                                              sprintf(table, "H:%02dM:%02dS:%02d W:%d", (int)(pTime[8]*10 + pTime[9]),
  71   4                                                                                                                        (int)(pTime[10]*10 + pTime[11]),
  72   4                                                                                                                        (int)(pTime[12]*10 + pTime[13]),
  73   4                                                                                                                        (int)(pTime[14]));                                                                      
  74   4                                              LcdShowStr(0x80 + 0x40,table);  
  75   4                                      }
  76   3                              break;
  77   3                              default:break;
  78   3                      }
  79   2                              
  80   2              
  81   2              
  82   2              }
  83   1      }
  84          void lcd_display(void)
  85          {
  86   1              LcdInit();      
  87   1              LcdShowStr(0x80 ,"   Welcome use  ");
  88   1              LcdShowStr(0x80 + 0x40 ,"  Thermometer   ");
  89   1              Delay200ms();
  90   1              Delay200ms();
  91   1              LcdShowStr(0x80 ,"  class: b16   ");
  92   1              LcdShowStr(0x80+ 0x40,"   name: LL     ");
  93   1              Delay200ms();
  94   1              Delay200ms();
  95   1              Delay200ms();
  96   1              Delay200ms();
  97   1              LcdShowStr(0x80,"HUMI:XXXXX  ");
  98   1              lcdshowCelsius(0x80 + 12);
  99   1              LcdShowStr(0x80 + 0x40,"TEMP:XXXXX  % ");       
 100   1      }
 101          
 102          
 103          
 104          
 105          
 106          
 107          
 108          
 109          
 110          
 111          
 112          
 113          
 114          
 115          
 116          
C51 COMPILER V9.60.0.0   BSP_MAIN                                                          02/26/2020 22:34:49 PAGE 3   

 117          
 118          
 119          
 120          
 121          
 122          
 123          
 124          
 125          
 126          
 127          
 128          
 129          
 130          
 131          
 132          
 133          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    692    ----
   CONSTANT SIZE    =    173    ----
   XDATA SIZE       =   ----      25
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
